==========================================
Multi-Objective SAC EnergyNet Continue Training (SLURM)
==========================================
Job ID: 324376
Job Name: test_continue_pcs
Node: lambda1
CPUs: 4
GPUs: 0
Memory: 32768 MB
==========================================
Original directory (where files are): /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing
Model path: /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/Experiments/First/models/train_energynet_full_opt_0_action_no_disp_1754339196_final.pth
Loading CUDA modules...
No CUDA modules loaded
✓ Set CUDA environment variables
Activating conda environment...
✓ Activated conda environment: IsoMOEnergyNet
Found Python: python3 (/home/matan.biton/miniconda3/envs/IsoMOEnergyNet/bin/python3)
Python version: Python 3.10.9
Python location: /home/matan.biton/miniconda3/envs/IsoMOEnergyNet/bin/python3

Checking CUDA availability...
CUDA_HOME: /usr/local/cuda
CUDA_PATH: /usr/local/cuda
GPU Status:
0, NVIDIA GeForce GTX 1080 Ti, 11264, 2
Checking PyTorch CUDA support...
PyTorch version: 2.7.0+cu126
PyTorch CUDA available: True
✓ PyTorch CUDA support is working

Creating working directory: /tmp/energynet_continue_training_matan.biton_3626269
Copying files to working directory...
Copied multi_objective_sac.py from parent directory
Copied EnergyNetMoISO directory from /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing/../../EnergyNetMoISO
Changed to working directory: /tmp/energynet_continue_training_matan.biton_3626269
Files in working directory:
total 18864
drwxr-xr-x 7 matan.biton domain^users     4096 Aug  5 22:40 .
drwxrwxrwt 1 root        root         19025920 Aug  5 22:40 ..
-rwxr-xr-x 1 matan.biton domain^users    11270 Aug  5 22:40 average_tensorboard_logs.py
drwxr-xr-x 2 matan.biton domain^users     4096 Aug  5 22:40 checkpoints
-rw-r--r-- 1 matan.biton domain^users    21796 Aug  5 22:40 continue_train_energynet.py
drwxr-xr-x 4 matan.biton domain^users     4096 Aug  5 22:40 EnergyNetMoISO
-rw-r--r-- 1 matan.biton domain^users     9719 Aug  5 22:40 examples.py
-rw-r--r-- 1 matan.biton domain^users       37 Aug  5 22:40 __init__.py
drwxr-xr-x 2 matan.biton domain^users     4096 Aug  5 22:40 logs
drwxr-xr-x 2 matan.biton domain^users     4096 Aug  5 22:40 models
-rw-r--r-- 1 matan.biton domain^users    46082 Aug  5 22:40 multi_objective_sac.py
-rw-r--r-- 1 matan.biton domain^users    10101 Aug  5 22:40 optimization_examples.py
drwxr-xr-x 2 matan.biton domain^users     4096 Aug  5 22:40 plots
-rw-r--r-- 1 matan.biton domain^users     4016 Aug  5 22:40 quick_test.py
-rw-r--r-- 1 matan.biton domain^users      503 Aug  5 22:40 requirements.txt
-rwxr-xr-x 1 matan.biton domain^users        0 Aug  5 22:40 test_averaging.py
-rw-r--r-- 1 matan.biton domain^users    17868 Aug  5 22:40 test_environments.py
-rw-r--r-- 1 matan.biton domain^users     2970 Aug  5 22:40 test_gpu_availability.py
-rwxr-xr-x 1 matan.biton domain^users     6012 Aug  5 22:40 test_gpu_quick.py
-rw-r--r-- 1 matan.biton domain^users     4458 Aug  5 22:40 test_imports.py
-rw-r--r-- 1 matan.biton domain^users    14966 Aug  5 22:40 test_mo_sac.py
-rw-r--r-- 1 matan.biton domain^users    12212 Aug  5 22:40 test_mo_sac_quick.py
-rw-r--r-- 1 matan.biton domain^users    12772 Aug  5 22:40 test_optimizations.py
-rw-r--r-- 1 matan.biton domain^users     5076 Aug  5 22:40 test_pcs_loading.py
-rw-r--r-- 1 matan.biton domain^users    20689 Aug  5 22:40 train_energynet.py

Testing Python imports...
Python path will include:
  - Current directory: /tmp/energynet_continue_training_matan.biton_3626269
  - Parent directories will be added by the script
Testing basic dependencies...
✓ Basic dependencies (torch, numpy, gymnasium, matplotlib) available
Testing multi_objective_sac import...
✓ multi_objective_sac import successful
Testing EnergyNetMoISO import...
Registering PCSUnitEnv-v0
Registering ISOEnv-v0
Registering EnergyNetEnv-v0
Registering ISO-RLZoo-v0
Registering PCS-RLZoo-v0
✓ EnergyNetMoISO import successful

Running under SLURM job manager
Set OMP_NUM_THREADS to 4
GPU devices: 0
✓ GPU training enabled
Continue Training Parameters:
  Model Path: /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/Experiments/First/models/train_energynet_full_opt_0_action_no_disp_1754339196_final.pth
  Additional Timesteps: 5000
  Experiment Name: test_with_pcs
  Random Seed: Not specified (will use random)

Environment Configuration:
  Use Dispatch Action: false
  Dispatch Strategy: PROPORTIONAL
  Trained PCS Model: /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/training/pcs_experiments/models/with_opt_iso_opt_no_disp_final.pth
  ✓ PCS model file found

Optimization Parameter Overrides:
  LR Annealing: false
  Reward Scaling: false
  Value Clipping: false

Running EnergyNet continue training...
Command: python3 continue_train_energynet.py --model-path /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/Experiments/First/models/train_energynet_full_opt_0_action_no_disp_1754339196_final.pth --total-timesteps 5000 --save-dir . --experiment-name continue_train_energynet_test_with_pcs --eval-freq 5000 --save-freq 10000 --verbose --dispatch-strategy PROPORTIONAL --trained-pcs-model /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/training/pcs_experiments/models/with_opt_iso_opt_no_disp_final.pth

Registering PCSUnitEnv-v0
Registering ISOEnv-v0
Registering EnergyNetEnv-v0
Registering ISO-RLZoo-v0
Registering PCS-RLZoo-v0
================================================================================
Continuing MO-SAC Training on EnergyNet MoISO Environment
Loading from: /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/Experiments/First/models/train_energynet_full_opt_0_action_no_disp_1754339196_final.pth
Experiment: continue_train_energynet_test_with_pcs
================================================================================
Loading PCS model from: /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/training/pcs_experiments/models/with_opt_iso_opt_no_disp_final.pth
✓ Successfully loaded PCS model
Test prediction successful: (tensor([9.9775]), None)
Model loaded successfully, testing prediction...
Test prediction successful: (tensor([9.9775]), None)
Agent 0 fully initialized
Agent 0 fully initialized
Agent 0 loading status: Failed
Environment Configuration:
  State dimension: 3
  Action dimension: 2
  Reward dimension: 2
  Action bounds: (1.0, 10.0)
  Environment config: {'use_dispatch_action': False, 'dispatch_strategy': 'PROPORTIONAL', 'trained_pcs_model': '/home/matan.biton/EnergyNetMultiObjectiveISOWrapper/training/pcs_experiments/models/with_opt_iso_opt_no_disp_final.pth'}
\nLoading existing model configuration...
  Loaded weights: [0.6 0.4]
  Training step: 290001
  Episode count: 6298
Using device: cuda
GPU: NVIDIA GeForce GTX 1080 Ti
GPU Memory: 10.9 GB
CUDA Version: 12.6
Optimization features enabled:
  LR Annealing: False
  Reward Scaling: False
  Orthogonal Init: False
  Value Clipping: False
\nLoading trained model state...
Model loaded from /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/Experiments/First/models/train_energynet_full_opt_0_action_no_disp_1754339196_final.pth
Loaded optimization settings:
  LR Annealing: True
  Reward Scaling: True
  Orthogonal Init: True
  Value Clipping: True
    Clip range: 200.0
\nAgent Configuration (after loading):
  Actor LR: 0.0003
  Critic LR: 0.0003
  Alpha LR: 0.0003
  Gamma: 0.99
  Tau: 0.005
  Buffer capacity: 1000000
  Batch size: 256
\nOptimization Features:
  LR Annealing: False
  Reward Scaling: False
  Value Clipping: False
  Tensorboard log: ./logs/continue_train_energynet_test_with_pcs_1754422851
\nEvaluating current model performance...
  Current performance (10 episodes):
    Cost reward: -728579.008 ± 3536.575
    Stability reward: -42.895 ± 17.683
    Scalarized: -437164.563
\n============================================================
Continuing Training...
============================================================
Episode 1: Reward [-7.31836002e+05 -5.91800108e+01], Scalarized: -439125.273, Length 48
Episode 2: Reward [-7.28771823e+05 -4.38591171e+01], Scalarized: -437280.638, Length 48
Episode 3: Reward [-7.31841644e+05 -5.92082199e+01], Scalarized: -439128.670, Length 48
Episode 4: Reward [-7.34067453e+05 -7.03372661e+01], Scalarized: -440468.607, Length 48
Episode 5: Reward [-7.28181371e+05 -4.09068542e+01], Scalarized: -436925.185, Length 48
Episode 6: Reward [-7.21406196e+05 -7.03097868e+00], Scalarized: -432846.530, Length 48
Episode 7: Reward [-7.35174772e+05 -7.58738597e+01], Scalarized: -441135.213, Length 48
Episode 8: Reward [-7.26574910e+05 -3.28745509e+01], Scalarized: -435958.096, Length 48
Episode 9: Reward [-7.27283348e+05 -3.64167400e+01], Scalarized: -436384.576, Length 48
Episode 10: Reward [-7.29422701e+05 -4.71135057e+01], Scalarized: -437672.466, Length 48
Episode 11: Reward [-7.24699643e+05 -2.34982167e+01], Scalarized: -434829.185, Length 48
Episode 12: Reward [-7.34300243e+05 -7.15012135e+01], Scalarized: -440608.746, Length 48
Episode 13: Reward [-7.25670533e+05 -2.83526653e+01], Scalarized: -435413.661, Length 48
Episode 14: Reward [-7.25755863e+05 -2.87793162e+01], Scalarized: -435465.030, Length 48
Episode 15: Reward [-7.29540923e+05 -4.77046142e+01], Scalarized: -437743.636, Length 48
Episode 16: Reward [-7.24063105e+05 -2.03155243e+01], Scalarized: -434445.989, Length 48
Episode 17: Reward [-7.22598763e+05 -1.29938136e+01], Scalarized: -433564.455, Length 48
Episode 18: Reward [-7.26045703e+05 -3.02285143e+01], Scalarized: -435639.513, Length 48
Episode 19: Reward [-7.27284499e+05 -3.64224973e+01], Scalarized: -436385.269, Length 48
Episode 20: Reward [-7.39211069e+05 -9.60553464e+01], Scalarized: -443565.064, Length 48
Episode 21: Reward [-7.30607184e+05 -5.30359193e+01], Scalarized: -438385.525, Length 48
Episode 22: Reward [-7.23615656e+05 -1.80782818e+01], Scalarized: -434176.625, Length 48
Episode 23: Reward [-7.25454581e+05 -2.72729062e+01], Scalarized: -435283.658, Length 48
Episode 24: Reward [-7.27569050e+05 -3.78452515e+01], Scalarized: -436556.568, Length 48
Episode 25: Reward [-7.29325290e+05 -4.66264477e+01], Scalarized: -437613.824, Length 48
Episode 26: Reward [-7.29680161e+05 -4.84008028e+01], Scalarized: -437827.457, Length 48
Episode 27: Reward [-7.28088715e+05 -4.04435733e+01], Scalarized: -436869.406, Length 48
Episode 28: Reward [-7.25201986e+05 -2.60099301e+01], Scalarized: -435131.596, Length 48
Episode 29: Reward [-7.27791011e+05 -3.89550568e+01], Scalarized: -436690.189, Length 48
Episode 30: Reward [-7.29314636e+05 -4.65731822e+01], Scalarized: -437607.411, Length 48
Episode 31: Reward [-7.23526390e+05 -1.76319487e+01], Scalarized: -434122.887, Length 48
Episode 32: Reward [-7.31120259e+05 -5.56012960e+01], Scalarized: -438694.396, Length 48
Episode 33: Reward [-7.33390384e+05 -6.69519195e+01], Scalarized: -440061.011, Length 48
Episode 34: Reward [-7.30335311e+05 -5.16765567e+01], Scalarized: -438221.857, Length 48
Episode 35: Reward [-7.30738626e+05 -5.36931290e+01], Scalarized: -438464.653, Length 48
Episode 36: Reward [-7.23661720e+05 -1.83086022e+01], Scalarized: -434204.356, Length 48
Episode 37: Reward [-7.21929353e+05 -9.64676408e+00], Scalarized: -433161.470, Length 48
Episode 38: Reward [-7.24921159e+05 -2.46057960e+01], Scalarized: -434962.538, Length 48
Episode 39: Reward [-7.28312401e+05 -4.15620047e+01], Scalarized: -437004.065, Length 48
Episode 40: Reward [-7.29208021e+05 -4.60401034e+01], Scalarized: -437543.228, Length 48
Episode 41: Reward [-7.26499090e+05 -3.24954491e+01], Scalarized: -435912.452, Length 48
Episode 42: Reward [-7.31679147e+05 -5.83957335e+01], Scalarized: -439030.846, Length 48
Episode 43: Reward [-7.30930500e+05 -5.46525016e+01], Scalarized: -438580.161, Length 48
Episode 44: Reward [-7.32875978e+05 -6.43798910e+01], Scalarized: -439751.339, Length 48
Episode 45: Reward [-7.24773476e+05 -2.38673822e+01], Scalarized: -434873.633, Length 48
Episode 46: Reward [-7.37574591e+05 -8.78729535e+01], Scalarized: -442579.904, Length 48
Episode 47: Reward [-7.26278263e+05 -3.13913153e+01], Scalarized: -435779.514, Length 48
Episode 48: Reward [-7.35506263e+05 -7.75313150e+01], Scalarized: -441334.770, Length 48
Episode 49: Reward [-7.31300206e+05 -5.65010294e+01], Scalarized: -438802.724, Length 48
Episode 50: Reward [-7.23708932e+05 -1.85446617e+01], Scalarized: -434232.777, Length 48
Episode 51: Reward [-7.32513065e+05 -6.25653266e+01], Scalarized: -439532.865, Length 48
Episode 52: Reward [-7.27017198e+05 -3.50859875e+01], Scalarized: -436224.353, Length 48
Episode 53: Reward [-7.31216250e+05 -5.60812489e+01], Scalarized: -438752.182, Length 48
Episode 54: Reward [-7.24091365e+05 -2.04568255e+01], Scalarized: -434463.002, Length 48
Episode 55: Reward [-7.32760511e+05 -6.38025546e+01], Scalarized: -439681.828, Length 48
Episode 56: Reward [-7.32465289e+05 -6.23264447e+01], Scalarized: -439504.104, Length 48
Episode 57: Reward [-7.25402310e+05 -2.70115498e+01], Scalarized: -435252.191, Length 48
Episode 58: Reward [-7.26532071e+05 -3.26603566e+01], Scalarized: -435932.307, Length 48
Episode 59: Reward [-7.31131073e+05 -5.56553662e+01], Scalarized: -438700.906, Length 48
Episode 60: Reward [-7.28844289e+05 -4.42214440e+01], Scalarized: -437324.262, Length 48
Episode 61: Reward [-7.35544578e+05 -7.77228879e+01], Scalarized: -441357.836, Length 48
Episode 62: Reward [-7.25698751e+05 -2.84937566e+01], Scalarized: -435430.648, Length 48
Episode 63: Reward [-7.2974985e+05 -4.8749248e+01], Scalarized: -437869.409, Length 48
Episode 64: Reward [-7.32820286e+05 -6.41014321e+01], Scalarized: -439717.812, Length 48
Episode 65: Reward [-7.34008738e+05 -7.00436875e+01], Scalarized: -440433.260, Length 48
Episode 66: Reward [-7.30039982e+05 -5.01999090e+01], Scalarized: -438044.069, Length 48
Episode 67: Reward [-7.31742781e+05 -5.87139047e+01], Scalarized: -439069.154, Length 48
Episode 68: Reward [-7.28740295e+05 -4.37014750e+01], Scalarized: -437261.658, Length 48
Episode 69: Reward [-7.31315846e+05 -5.65792287e+01], Scalarized: -438812.139, Length 48
Episode 70: Reward [-7.26620844e+05 -3.31042201e+01], Scalarized: -435985.748, Length 48
Episode 71: Reward [-7.25853991e+05 -2.92699560e+01], Scalarized: -435524.103, Length 48
Episode 72: Reward [-7.29245750e+05 -4.62287485e+01], Scalarized: -437565.941, Length 48
Episode 73: Reward [-7.20607769e+05 -3.03884546e+00], Scalarized: -432365.877, Length 48
Episode 74: Reward [-7.26266088e+05 -3.13304398e+01], Scalarized: -435772.185, Length 48
Episode 75: Reward [-7.23526875e+05 -1.76343758e+01], Scalarized: -434123.179, Length 48
Episode 76: Reward [-7.24922981e+05 -2.46149068e+01], Scalarized: -434963.635, Length 48
Episode 77: Reward [-7.30745238e+05 -5.37261924e+01], Scalarized: -438468.634, Length 48
Episode 78: Reward [-7.25599551e+05 -2.79977546e+01], Scalarized: -435370.930, Length 48
Episode 79: Reward [-7.28123519e+05 -4.06175949e+01], Scalarized: -436890.358, Length 48
Episode 80: Reward [-7.21137158e+05 -5.68578876e+00], Scalarized: -432684.569, Length 48
Episode 81: Reward [-7.34632768e+05 -7.31638403e+01], Scalarized: -440808.926, Length 48
Episode 82: Reward [-7.2370805e+05 -1.8540252e+01], Scalarized: -434232.246, Length 48
Episode 83: Reward [-7.26677419e+05 -3.33870947e+01], Scalarized: -436019.806, Length 48
Episode 84: Reward [-7.36036352e+05 -8.01817598e+01], Scalarized: -441653.884, Length 48
Episode 85: Reward [-7.27095099e+05 -3.54754942e+01], Scalarized: -436271.249, Length 48
Episode 86: Reward [-7.32869840e+05 -6.43492007e+01], Scalarized: -439747.644, Length 48
Episode 87: Reward [-7.24191653e+05 -2.09582651e+01], Scalarized: -434523.375, Length 48
Episode 88: Reward [-7.22952756e+05 -1.47637806e+01], Scalarized: -433777.559, Length 48
Episode 89: Reward [-7.30441772e+05 -5.22088597e+01], Scalarized: -438285.947, Length 48
Episode 90: Reward [-7.28265654e+05 -4.13282678e+01], Scalarized: -436975.923, Length 48
Episode 91: Reward [-7.30855649e+05 -5.42782449e+01], Scalarized: -438535.101, Length 48
Episode 92: Reward [-7.32690286e+05 -6.34514282e+01], Scalarized: -439639.552, Length 48
Episode 93: Reward [-7.30229291e+05 -5.11464559e+01], Scalarized: -438158.033, Length 48
Episode 94: Reward [-7.35938235e+05 -7.96911742e+01], Scalarized: -441594.817, Length 48
Episode 95: Reward [-7.32312829e+05 -6.15641468e+01], Scalarized: -439412.323, Length 48
Episode 96: Reward [-7.33724699e+05 -6.86234934e+01], Scalarized: -440262.269, Length 48
Episode 97: Reward [-7.29646462e+05 -4.82323119e+01], Scalarized: -437807.170, Length 48
Episode 98: Reward [-7.24447331e+05 -2.22366567e+01], Scalarized: -434677.293, Length 48
Episode 99: Reward [-7.30844033e+05 -5.42201641e+01], Scalarized: -438528.108, Length 48
Episode 100: Reward [-7.24642637e+05 -2.32131864e+01], Scalarized: -434794.868, Length 48
Episode 101: Reward [-7.28816962e+05 -4.40848091e+01], Scalarized: -437307.811, Length 48
Episode 102: Reward [-7.27258904e+05 -3.62945207e+01], Scalarized: -436369.860, Length 48
Episode 103: Reward [-7.28990795e+05 -4.49539758e+01], Scalarized: -437412.459, Length 48
Episode 104: Reward [-7.30627628e+05 -5.31381390e+01], Scalarized: -438397.832, Length 48
TensorBoard logger closed and data flushed
\n============================================================
Training Completed!
============================================================
Additional training time: 25.49 seconds (0.01 hours)
\nPerforming final evaluation...
\nFinal Performance (50 episodes):
  Cost reward: -728145.191 ± 3641.804
  Stability reward: -40.726 ± 18.209
  Scalarized reward: -436903.405 ± 2192.366
\nImprovement:
  Cost reward: +433.816
  Stability reward: +2.169
  Scalarized: +261.158
Model saved to ./models/continue_train_energynet_test_with_pcs_1754422851_final.pth
\nResults saved:
  Config: ./continue_train_energynet_test_with_pcs_1754422851_config.json
  Results: ./continue_train_energynet_test_with_pcs_1754422851_results.json
  Final model: ./models/continue_train_energynet_test_with_pcs_1754422851_final.pth
  Tensorboard logs: ./logs/continue_train_energynet_test_with_pcs_1754422851
\nContinued training completed successfully!
Final scalarized performance: -436903.405
Improvement: +261.158
Copying results back to original directory...
Models copied to: /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing/models/
Logs (including TensorBoard) copied to: /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing/logs/
Final model copied to root directory

==========================================
EnergyNet continue training completed successfully!
==========================================
SLURM Job ID: 324376
Original Model: /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/Experiments/First/models/train_energynet_full_opt_0_action_no_disp_1754339196_final.pth
Experiment Name: continue_train_energynet_test_with_pcs
Additional Training Timesteps: 5000
Results copied back to: /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing

Results should be in:
  - /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing/                (config and results files: continue_train_energynet_test_with_pcs_*)
  - /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing/models/         (continued trained model files)
  - /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing/logs/           (tensorboard logs: continue_train_energynet_test_with_pcs)
  - /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing/plots/          (training plots and analysis)
  - /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing/checkpoints/    (training checkpoints)

To view results:
  ./view_results.sh

To view tensorboard logs:
  tensorboard --logdir /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing/logs/ --host 0.0.0.0 --port 6006

SLURM output files:
  - slurm_continue_energynet_324376.out (standard output)
  - slurm_continue_energynet_324376.err (error output)
Cleaning up temporary directory: /tmp/energynet_continue_training_matan.biton_3626269
