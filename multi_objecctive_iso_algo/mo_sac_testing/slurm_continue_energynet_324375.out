==========================================
Multi-Objective SAC EnergyNet Continue Training (SLURM)
==========================================
Job ID: 324375
Job Name: test_continue_fix
Node: lambda1
CPUs: 4
GPUs: 0
Memory: 32768 MB
==========================================
Original directory (where files are): /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing
Model path: /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/Experiments/First/models/train_energynet_full_opt_0_action_no_disp_1754339196_final.pth
Loading CUDA modules...
No CUDA modules loaded
✓ Set CUDA environment variables
Activating conda environment...
✓ Activated conda environment: IsoMOEnergyNet
Found Python: python3 (/home/matan.biton/miniconda3/envs/IsoMOEnergyNet/bin/python3)
Python version: Python 3.10.9
Python location: /home/matan.biton/miniconda3/envs/IsoMOEnergyNet/bin/python3

Checking CUDA availability...
CUDA_HOME: /usr/local/cuda
CUDA_PATH: /usr/local/cuda
GPU Status:
0, NVIDIA GeForce GTX 1080 Ti, 11264, 2
Checking PyTorch CUDA support...
PyTorch version: 2.7.0+cu126
PyTorch CUDA available: True
✓ PyTorch CUDA support is working

Creating working directory: /tmp/energynet_continue_training_matan.biton_3626169
Copying files to working directory...
Copied multi_objective_sac.py from parent directory
Copied EnergyNetMoISO directory from /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing/../../EnergyNetMoISO
Changed to working directory: /tmp/energynet_continue_training_matan.biton_3626169
Files in working directory:
total 18864
drwxr-xr-x 7 matan.biton domain^users     4096 Aug  5 22:40 .
drwxrwxrwt 1 root        root         19025920 Aug  5 22:40 ..
-rwxr-xr-x 1 matan.biton domain^users    11270 Aug  5 22:40 average_tensorboard_logs.py
drwxr-xr-x 2 matan.biton domain^users     4096 Aug  5 22:40 checkpoints
-rw-r--r-- 1 matan.biton domain^users    21796 Aug  5 22:40 continue_train_energynet.py
drwxr-xr-x 4 matan.biton domain^users     4096 Aug  5 22:40 EnergyNetMoISO
-rw-r--r-- 1 matan.biton domain^users     9719 Aug  5 22:40 examples.py
-rw-r--r-- 1 matan.biton domain^users       37 Aug  5 22:40 __init__.py
drwxr-xr-x 2 matan.biton domain^users     4096 Aug  5 22:40 logs
drwxr-xr-x 2 matan.biton domain^users     4096 Aug  5 22:40 models
-rw-r--r-- 1 matan.biton domain^users    46082 Aug  5 22:40 multi_objective_sac.py
-rw-r--r-- 1 matan.biton domain^users    10101 Aug  5 22:40 optimization_examples.py
drwxr-xr-x 2 matan.biton domain^users     4096 Aug  5 22:40 plots
-rw-r--r-- 1 matan.biton domain^users     4016 Aug  5 22:40 quick_test.py
-rw-r--r-- 1 matan.biton domain^users      503 Aug  5 22:40 requirements.txt
-rwxr-xr-x 1 matan.biton domain^users        0 Aug  5 22:40 test_averaging.py
-rw-r--r-- 1 matan.biton domain^users    17868 Aug  5 22:40 test_environments.py
-rw-r--r-- 1 matan.biton domain^users     2970 Aug  5 22:40 test_gpu_availability.py
-rwxr-xr-x 1 matan.biton domain^users     6012 Aug  5 22:40 test_gpu_quick.py
-rw-r--r-- 1 matan.biton domain^users     4458 Aug  5 22:40 test_imports.py
-rw-r--r-- 1 matan.biton domain^users    14966 Aug  5 22:40 test_mo_sac.py
-rw-r--r-- 1 matan.biton domain^users    12212 Aug  5 22:40 test_mo_sac_quick.py
-rw-r--r-- 1 matan.biton domain^users    12772 Aug  5 22:40 test_optimizations.py
-rw-r--r-- 1 matan.biton domain^users     5076 Aug  5 22:40 test_pcs_loading.py
-rw-r--r-- 1 matan.biton domain^users    20689 Aug  5 22:40 train_energynet.py

Testing Python imports...
Python path will include:
  - Current directory: /tmp/energynet_continue_training_matan.biton_3626169
  - Parent directories will be added by the script
Testing basic dependencies...
✓ Basic dependencies (torch, numpy, gymnasium, matplotlib) available
Testing multi_objective_sac import...
✓ multi_objective_sac import successful
Testing EnergyNetMoISO import...
Registering PCSUnitEnv-v0
Registering ISOEnv-v0
Registering EnergyNetEnv-v0
Registering ISO-RLZoo-v0
Registering PCS-RLZoo-v0
✓ EnergyNetMoISO import successful

Running under SLURM job manager
Set OMP_NUM_THREADS to 4
GPU devices: 0
✓ GPU training enabled
Continue Training Parameters:
  Model Path: /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/Experiments/First/models/train_energynet_full_opt_0_action_no_disp_1754339196_final.pth
  Additional Timesteps: 5000
  Experiment Name: test_fix
  Random Seed: Not specified (will use random)

Environment Configuration:
  Use Dispatch Action: false
  Dispatch Strategy: PROPORTIONAL
  Trained PCS Model: None (using default PCS)

Optimization Parameter Overrides:
  LR Annealing: false
  Reward Scaling: false
  Value Clipping: false

Running EnergyNet continue training...
Command: python3 continue_train_energynet.py --model-path /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/Experiments/First/models/train_energynet_full_opt_0_action_no_disp_1754339196_final.pth --total-timesteps 5000 --save-dir . --experiment-name continue_train_energynet_test_fix --eval-freq 5000 --save-freq 10000 --verbose --dispatch-strategy PROPORTIONAL

Registering PCSUnitEnv-v0
Registering ISOEnv-v0
Registering EnergyNetEnv-v0
Registering ISO-RLZoo-v0
Registering PCS-RLZoo-v0
================================================================================
Continuing MO-SAC Training on EnergyNet MoISO Environment
Loading from: /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/Experiments/First/models/train_energynet_full_opt_0_action_no_disp_1754339196_final.pth
Experiment: continue_train_energynet_test_fix
================================================================================
Environment Configuration:
  State dimension: 3
  Action dimension: 2
  Reward dimension: 2
  Action bounds: (1.0, 10.0)
  Environment config: {'use_dispatch_action': False, 'dispatch_strategy': 'PROPORTIONAL', 'trained_pcs_model': None}
\nLoading existing model configuration...
  Loaded weights: [0.6 0.4]
  Training step: 290001
  Episode count: 6298
Using device: cuda
GPU: NVIDIA GeForce GTX 1080 Ti
GPU Memory: 10.9 GB
CUDA Version: 12.6
Optimization features enabled:
  LR Annealing: False
  Reward Scaling: False
  Orthogonal Init: False
  Value Clipping: False
\nLoading trained model state...
Model loaded from /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/Experiments/First/models/train_energynet_full_opt_0_action_no_disp_1754339196_final.pth
Loaded optimization settings:
  LR Annealing: True
  Reward Scaling: True
  Orthogonal Init: True
  Value Clipping: True
    Clip range: 200.0
\nAgent Configuration (after loading):
  Actor LR: 0.0003
  Critic LR: 0.0003
  Alpha LR: 0.0003
  Gamma: 0.99
  Tau: 0.005
  Buffer capacity: 1000000
  Batch size: 256
\nOptimization Features:
  LR Annealing: False
  Reward Scaling: False
  Value Clipping: False
  Tensorboard log: ./logs/continue_train_energynet_test_fix_1754422827
\nEvaluating current model performance...
  Current performance (10 episodes):
    Cost reward: -759123.191 ± 8230.428
    Stability reward: -195.616 ± 41.152
    Scalarized: -455552.161
\n============================================================
Continuing Training...
============================================================
Episode 1: Reward [-7.56196978e+05 -1.80984891e+02], Scalarized: -453790.581, Length 48
Episode 2: Reward [-7.52386908e+05 -1.61934540e+02], Scalarized: -451496.919, Length 48
Episode 3: Reward [-7.46730327e+05 -1.33651635e+02], Scalarized: -448091.657, Length 48
Episode 4: Reward [-7.54752262e+05 -1.73761310e+02], Scalarized: -452920.862, Length 48
Episode 5: Reward [-7.64378228e+05 -2.21891139e+02], Scalarized: -458715.693, Length 48
Episode 6: Reward [-7.60260870e+05 -2.01304349e+02], Scalarized: -456237.044, Length 48
Episode 7: Reward [-7.48057125e+05 -1.40285626e+02], Scalarized: -448890.389, Length 48
Episode 8: Reward [-7.590347e+05 -1.951735e+02], Scalarized: -455498.889, Length 48
Episode 9: Reward [-7.54865499e+05 -1.74327493e+02], Scalarized: -452989.030, Length 48
Episode 10: Reward [-7.8365687e+05 -3.1828435e+02], Scalarized: -470321.436, Length 48
Episode 11: Reward [-7.49960288e+05 -1.49801438e+02], Scalarized: -450036.093, Length 48
Episode 12: Reward [-7.59739571e+05 -1.98697853e+02], Scalarized: -455923.222, Length 48
Episode 13: Reward [-7.54824968e+05 -1.74124839e+02], Scalarized: -452964.631, Length 48
Episode 14: Reward [-7.48925364e+05 -1.44626820e+02], Scalarized: -449413.069, Length 48
Episode 15: Reward [-7.61825898e+05 -2.09129489e+02], Scalarized: -457179.191, Length 48
Episode 16: Reward [-7.66642300e+05 -2.33211502e+02], Scalarized: -460078.665, Length 48
Episode 17: Reward [-7.51391112e+05 -1.56955561e+02], Scalarized: -450897.450, Length 48
Episode 18: Reward [-7.59778372e+05 -1.98891861e+02], Scalarized: -455946.580, Length 48
Episode 19: Reward [-7.57603654e+05 -1.88018268e+02], Scalarized: -454637.399, Length 48
Episode 20: Reward [-7.66179747e+05 -2.30898735e+02], Scalarized: -459800.208, Length 48
Episode 21: Reward [-7.52539223e+05 -1.62696117e+02], Scalarized: -451588.613, Length 48
Episode 22: Reward [-7.61852620e+05 -2.09263102e+02], Scalarized: -457195.278, Length 48
Episode 23: Reward [-7.50332449e+05 -1.51662246e+02], Scalarized: -450260.134, Length 48
Episode 24: Reward [-7.65899751e+05 -2.29498755e+02], Scalarized: -459631.650, Length 48
Episode 25: Reward [-7.51125347e+05 -1.55626733e+02], Scalarized: -450737.459, Length 48
Episode 26: Reward [-7.68629567e+05 -2.43147836e+02], Scalarized: -461274.999, Length 48
Episode 27: Reward [-7.52877214e+05 -1.64386070e+02], Scalarized: -451792.083, Length 48
Episode 28: Reward [-7.56676116e+05 -1.83380581e+02], Scalarized: -454079.022, Length 48
Episode 29: Reward [-7.64875389e+05 -2.24376946e+02], Scalarized: -459014.984, Length 48
Episode 30: Reward [-7.57066009e+05 -1.85330043e+02], Scalarized: -454313.737, Length 48
Episode 31: Reward [-7.42549953e+05 -1.12749767e+02], Scalarized: -445575.072, Length 48
Episode 32: Reward [-7.53967619e+05 -1.69838094e+02], Scalarized: -452448.506, Length 48
Episode 33: Reward [-7.66652744e+05 -2.33263721e+02], Scalarized: -460084.952, Length 48
Episode 34: Reward [-7.57800393e+05 -1.89001966e+02], Scalarized: -454755.837, Length 48
Episode 35: Reward [-7.69903037e+05 -2.49515184e+02], Scalarized: -462041.628, Length 48
Episode 36: Reward [-7.56359154e+05 -1.81795770e+02], Scalarized: -453888.211, Length 48
Episode 37: Reward [-7.66045664e+05 -2.30228321e+02], Scalarized: -459719.490, Length 48
Episode 38: Reward [-7.61719681e+05 -2.08598406e+02], Scalarized: -457115.248, Length 48
Episode 39: Reward [-7.49612779e+05 -1.48063896e+02], Scalarized: -449826.893, Length 48
Episode 40: Reward [-7.56804748e+05 -1.84023738e+02], Scalarized: -454156.458, Length 48
Episode 41: Reward [-7.64876134e+05 -2.24380671e+02], Scalarized: -459015.433, Length 48
Episode 42: Reward [-7.47851450e+05 -1.39257252e+02], Scalarized: -448766.573, Length 48
Episode 43: Reward [-7.54008560e+05 -1.70042799e+02], Scalarized: -452473.153, Length 48
Episode 44: Reward [-7.58834297e+05 -1.94171485e+02], Scalarized: -455378.247, Length 48
Episode 45: Reward [-7.54663424e+05 -1.73317118e+02], Scalarized: -452867.381, Length 48
Episode 46: Reward [-7.50001699e+05 -1.50008493e+02], Scalarized: -450061.023, Length 48
Episode 47: Reward [-7.64058342e+05 -2.20291709e+02], Scalarized: -458523.122, Length 48
Episode 48: Reward [-7.62255093e+05 -2.11275464e+02], Scalarized: -457437.566, Length 48
Episode 49: Reward [-7.62915421e+05 -2.14577105e+02], Scalarized: -457835.083, Length 48
Episode 50: Reward [-7.56354638e+05 -1.81773188e+02], Scalarized: -453885.492, Length 48
Episode 51: Reward [-7.58954755e+05 -1.94773774e+02], Scalarized: -455450.762, Length 48
Episode 52: Reward [-7.63208131e+05 -2.16040657e+02], Scalarized: -458011.295, Length 48
Episode 53: Reward [-7.50392014e+05 -1.51960071e+02], Scalarized: -450295.993, Length 48
Episode 54: Reward [-7.58092347e+05 -1.90461736e+02], Scalarized: -454931.593, Length 48
Episode 55: Reward [-7.61912113e+05 -2.09560564e+02], Scalarized: -457231.092, Length 48
Episode 56: Reward [-7.51448565e+05 -1.57242825e+02], Scalarized: -450932.036, Length 48
Episode 57: Reward [-7.53443045e+05 -1.67215227e+02], Scalarized: -452132.713, Length 48
Episode 58: Reward [-7.55616338e+05 -1.78081688e+02], Scalarized: -453441.035, Length 48
Episode 59: Reward [-7.61706608e+05 -2.08533038e+02], Scalarized: -457107.378, Length 48
Episode 60: Reward [-7.63553658e+05 -2.17768292e+02], Scalarized: -458219.302, Length 48
Episode 61: Reward [-7.53256314e+05 -1.66281568e+02], Scalarized: -452020.301, Length 48
Episode 62: Reward [-7.63024659e+05 -2.15123297e+02], Scalarized: -457900.845, Length 48
Episode 63: Reward [-7.70178177e+05 -2.50890883e+02], Scalarized: -462207.262, Length 48
Episode 64: Reward [-7.52788368e+05 -1.63941839e+02], Scalarized: -451738.597, Length 48
Episode 65: Reward [-7.62288372e+05 -2.11441862e+02], Scalarized: -457457.600, Length 48
Episode 66: Reward [-7.60825095e+05 -2.04125475e+02], Scalarized: -456576.707, Length 48
Episode 67: Reward [-7.66779436e+05 -2.33897182e+02], Scalarized: -460161.221, Length 48
Episode 68: Reward [-7.56862924e+05 -1.84314621e+02], Scalarized: -454191.480, Length 48
Episode 69: Reward [-7.48271214e+05 -1.41356072e+02], Scalarized: -449019.271, Length 48
Episode 70: Reward [-7.62513195e+05 -2.12565976e+02], Scalarized: -457592.943, Length 48
Episode 71: Reward [-7.52267900e+05 -1.61339502e+02], Scalarized: -451425.276, Length 48
Episode 72: Reward [-7.81727732e+05 -3.08638658e+02], Scalarized: -469160.094, Length 48
Episode 73: Reward [-7.60060160e+05 -2.00300799e+02], Scalarized: -456116.216, Length 48
Episode 74: Reward [-7.62068288e+05 -2.10341441e+02], Scalarized: -457325.109, Length 48
Episode 75: Reward [-7.57464465e+05 -1.87322323e+02], Scalarized: -454553.608, Length 48
Episode 76: Reward [-7.56510542e+05 -1.82552710e+02], Scalarized: -453979.346, Length 48
Episode 77: Reward [-7.51475823e+05 -1.57379117e+02], Scalarized: -450948.446, Length 48
Episode 78: Reward [-7.53136057e+05 -1.65680284e+02], Scalarized: -451947.906, Length 48
Episode 79: Reward [-7.45099666e+05 -1.25498328e+02], Scalarized: -447109.999, Length 48
Episode 80: Reward [-7.60728893e+05 -2.03644465e+02], Scalarized: -456518.794, Length 48
Episode 81: Reward [-7.60366381e+05 -2.01831905e+02], Scalarized: -456300.561, Length 48
Episode 82: Reward [-7.62063377e+05 -2.10316883e+02], Scalarized: -457322.153, Length 48
Episode 83: Reward [-7.48147054e+05 -1.40735271e+02], Scalarized: -448944.527, Length 48
Episode 84: Reward [-7.68408798e+05 -2.42043991e+02], Scalarized: -461142.097, Length 48
Episode 85: Reward [-7.54318300e+05 -1.71591498e+02], Scalarized: -452659.616, Length 48
Episode 86: Reward [-7.72538994e+05 -2.62694969e+02], Scalarized: -463628.474, Length 48
Episode 87: Reward [-7.48248395e+05 -1.41241975e+02], Scalarized: -449005.534, Length 48
Episode 88: Reward [-7.56631623e+05 -1.83158113e+02], Scalarized: -454052.237, Length 48
Episode 89: Reward [-7.59730217e+05 -1.98651084e+02], Scalarized: -455917.591, Length 48
Episode 90: Reward [-7.57555081e+05 -1.87775403e+02], Scalarized: -454608.159, Length 48
Episode 91: Reward [-7.62439499e+05 -2.12197493e+02], Scalarized: -457548.578, Length 48
Episode 92: Reward [-7.56119069e+05 -1.80595347e+02], Scalarized: -453743.680, Length 48
Episode 93: Reward [-7.61959379e+05 -2.09796894e+02], Scalarized: -457259.546, Length 48
Episode 94: Reward [-7.54126883e+05 -1.70634417e+02], Scalarized: -452544.384, Length 48
Episode 95: Reward [-7.62584222e+05 -2.12921110e+02], Scalarized: -457635.702, Length 48
Episode 96: Reward [-7.49170009e+05 -1.45850045e+02], Scalarized: -449560.345, Length 48
Episode 97: Reward [-7.55294058e+05 -1.76470292e+02], Scalarized: -453247.023, Length 48
Episode 98: Reward [-7.40365757e+05 -1.01828787e+02], Scalarized: -444260.186, Length 48
Episode 99: Reward [-7.49371094e+05 -1.46855469e+02], Scalarized: -449681.398, Length 48
Episode 100: Reward [-7.53478555e+05 -1.67392777e+02], Scalarized: -452154.090, Length 48
Episode 101: Reward [-7.49629197e+05 -1.48145987e+02], Scalarized: -449836.777, Length 48
Episode 102: Reward [-7.50898359e+05 -1.54491796e+02], Scalarized: -450600.812, Length 48
Episode 103: Reward [-7.55618023e+05 -1.78090113e+02], Scalarized: -453442.050, Length 48
Episode 104: Reward [-7.65038312e+05 -2.25191561e+02], Scalarized: -459113.064, Length 48
TensorBoard logger closed and data flushed
\n============================================================
Training Completed!
============================================================
Additional training time: 21.57 seconds (0.01 hours)
\nPerforming final evaluation...
\nFinal Performance (50 episodes):
  Cost reward: -757759.872 ± 8044.526
  Stability reward: -188.799 ± 40.223
  Scalarized reward: -454731.443 ± 4842.805
\nImprovement:
  Cost reward: +1363.319
  Stability reward: +6.817
  Scalarized: +820.718
Model saved to ./models/continue_train_energynet_test_fix_1754422827_final.pth
\nResults saved:
  Config: ./continue_train_energynet_test_fix_1754422827_config.json
  Results: ./continue_train_energynet_test_fix_1754422827_results.json
  Final model: ./models/continue_train_energynet_test_fix_1754422827_final.pth
  Tensorboard logs: ./logs/continue_train_energynet_test_fix_1754422827
\nContinued training completed successfully!
Final scalarized performance: -454731.443
Improvement: +820.718
Copying results back to original directory...
Models copied to: /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing/models/
Logs (including TensorBoard) copied to: /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing/logs/
Final model copied to root directory

==========================================
EnergyNet continue training completed successfully!
==========================================
SLURM Job ID: 324375
Original Model: /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/Experiments/First/models/train_energynet_full_opt_0_action_no_disp_1754339196_final.pth
Experiment Name: continue_train_energynet_test_fix
Additional Training Timesteps: 5000
Results copied back to: /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing

Results should be in:
  - /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing/                (config and results files: continue_train_energynet_test_fix_*)
  - /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing/models/         (continued trained model files)
  - /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing/logs/           (tensorboard logs: continue_train_energynet_test_fix)
  - /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing/plots/          (training plots and analysis)
  - /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing/checkpoints/    (training checkpoints)

To view results:
  ./view_results.sh

To view tensorboard logs:
  tensorboard --logdir /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing/logs/ --host 0.0.0.0 --port 6006

SLURM output files:
  - slurm_continue_energynet_324375.out (standard output)
  - slurm_continue_energynet_324375.err (error output)
Cleaning up temporary directory: /tmp/energynet_continue_training_matan.biton_3626169
