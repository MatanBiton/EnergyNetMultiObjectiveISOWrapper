==========================================
Multi-Objective SAC EnergyNet Training v2 (SLURM)
==========================================
Job ID: 323274
Job Name: mo_sac_energynet_v2
Node: lambda1
CPUs: 4
GPUs: 0
Memory: 32768 MB
==========================================
Original directory (where files are): /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing
Loading CUDA modules...
No CUDA modules loaded
✓ Set CUDA environment variables
Activating conda environment...
✓ Activated conda environment: IsoMOEnergyNet
Found Python: python3 (/home/matan.biton/miniconda3/envs/IsoMOEnergyNet/bin/python3)
Python version: Python 3.10.9
Python location: /home/matan.biton/miniconda3/envs/IsoMOEnergyNet/bin/python3

Checking CUDA availability...
CUDA_HOME: /usr/local/cuda
CUDA_PATH: /usr/local/cuda
GPU Status:
0, NVIDIA GeForce RTX 2080 Ti, 11264, 1
Checking PyTorch CUDA support...
PyTorch version: 2.7.0+cu126
PyTorch CUDA available: True
✓ PyTorch CUDA support is working

Creating working directory: /tmp/energynet_training_matan.biton_2722186
Copying files to working directory...
Copied multi_objective_sac.py from parent directory
Copied EnergyNetMoISO directory from /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing/../../EnergyNetMoISO
Copied best_model.zip
Changed to working directory: /tmp/energynet_training_matan.biton_2722186
Files in working directory:
total 18836
drwxr-xr-x 7 matan.biton domain^users     4096 Jul 27 12:09 .
drwxrwxrwt 1 root        root         19025920 Jul 27 12:09 ..
-rw-r--r-- 1 matan.biton domain^users    80066 Jul 27 12:09 best_model.zip
drwxr-xr-x 2 matan.biton domain^users     4096 Jul 27 12:09 checkpoints
drwxr-xr-x 4 matan.biton domain^users     4096 Jul 27 12:09 EnergyNetMoISO
-rw-r--r-- 1 matan.biton domain^users     9719 Jul 27 12:09 examples.py
-rw-r--r-- 1 matan.biton domain^users       37 Jul 27 12:09 __init__.py
drwxr-xr-x 2 matan.biton domain^users     4096 Jul 27 12:09 logs
drwxr-xr-x 2 matan.biton domain^users     4096 Jul 27 12:09 models
-rw-r--r-- 1 matan.biton domain^users    22704 Jul 27 12:09 multi_objective_sac.py
drwxr-xr-x 2 matan.biton domain^users     4096 Jul 27 12:09 plots
-rw-r--r-- 1 matan.biton domain^users      503 Jul 27 12:09 requirements.txt
-rw-r--r-- 1 matan.biton domain^users    17868 Jul 27 12:09 test_environments.py
-rw-r--r-- 1 matan.biton domain^users     2970 Jul 27 12:09 test_gpu_availability.py
-rwxr-xr-x 1 matan.biton domain^users     6012 Jul 27 12:09 test_gpu_quick.py
-rw-r--r-- 1 matan.biton domain^users     4458 Jul 27 12:09 test_imports.py
-rw-r--r-- 1 matan.biton domain^users    14966 Jul 27 12:09 test_mo_sac.py
-rw-r--r-- 1 matan.biton domain^users    12212 Jul 27 12:09 test_mo_sac_quick.py
-rw-r--r-- 1 matan.biton domain^users    12639 Jul 27 12:09 train_energynet.py

Testing Python imports...
Python path will include:
  - Current directory: /tmp/energynet_training_matan.biton_2722186
  - Parent directories will be added by the script
Testing basic dependencies...
✓ Basic dependencies (torch, numpy, gymnasium, matplotlib) available
Testing multi_objective_sac import...
✓ multi_objective_sac import successful
Testing EnergyNetMoISO import...
Registering PCSUnitEnv-v0
Registering ISOEnv-v0
Registering EnergyNetEnv-v0
Registering ISO-RLZoo-v0
Registering PCS-RLZoo-v0
✓ EnergyNetMoISO import successful

Running under SLURM job manager
Set OMP_NUM_THREADS to 4
GPU devices: 0
✓ GPU training enabled
Training Parameters:
  Episodes: 2000
  Learning Rate: 0.0003
  Batch Size: 256

Running EnergyNet training...
Command: python3 train_energynet.py --total-timesteps 2000 --actor-lr 0.0003 --batch-size 256 --save-dir . --experiment-name energynet_training --eval-freq 5000 --save-freq 10000 --verbose

Registering PCSUnitEnv-v0
Registering ISOEnv-v0
Registering EnergyNetEnv-v0
Registering ISO-RLZoo-v0
Registering PCS-RLZoo-v0
================================================================================
Training MO-SAC on EnergyNet MoISO Environment
Experiment: energynet_training
================================================================================
Environment Configuration:
  State dimension: 3
  Action dimension: 2
  Reward dimension: 2
  Action bounds: (1.0, 10.0)
  Environment config: {'use_dispatch_action': False, 'dispatch_strategy': 'PROPORTIONAL'}
  Using provided weights: [0.6 0.4]
Using device: cuda
GPU: NVIDIA GeForce RTX 2080 Ti
GPU Memory: 10.8 GB
CUDA Version: 12.6

Agent Configuration:
  Actor LR: 0.0003, Critic LR: 0.0003, Alpha LR: 0.0003
  Gamma: 0.99, Tau: 0.005, Initial Alpha: 0.2
  Auto-tune Alpha: True
  Actor hidden dims: [256, 256]
  Critic hidden dims: [256, 256]
  Buffer capacity: 1000000, Batch size: 256
  Tensorboard log: ./logs/energynet_training_1753607390

============================================================
Starting Training...
============================================================
Episode 1: Reward [-7.2000000e+05 -1.5502001e+02], Length 48
Episode 2: Reward [-7.20000000e+05 -1.24250579e+02], Length 48
Episode 3: Reward [-7.20000000e+05 -2.28010055e+02], Length 48
Episode 4: Reward [-7.20000000e+05 -1.62202497e+02], Length 48
Episode 5: Reward [-7.20000000e+05 -2.31892008e+02], Length 48
Episode 6: Reward [-7.20000000e+05 -2.49125159e+02], Length 48
Episode 7: Reward [-7.20000000e+05 -2.75581062e+02], Length 48
Episode 8: Reward [-7.20000000e+05 -3.05449043e+02], Length 48
Episode 9: Reward [-7.20000000e+05 -2.22326743e+02], Length 48
Episode 10: Reward [-7.20000000e+05 -2.23408802e+02], Length 48
Episode 11: Reward [-7.20000000e+05 -1.98869792e+02], Length 48
Episode 12: Reward [-7.20000000e+05 -2.29952695e+02], Length 48
Episode 13: Reward [-7.2000000e+05 -1.4181348e+02], Length 48
Episode 14: Reward [-7.20000000e+05 -2.50544522e+02], Length 48
Episode 15: Reward [-7.20000000e+05 -1.54184439e+02], Length 48
Episode 16: Reward [-7.20000000e+05 -1.43143478e+02], Length 48
Episode 17: Reward [-7.20000000e+05 -2.15936861e+02], Length 48
Episode 18: Reward [-7.20000000e+05 -1.94985363e+02], Length 48
Episode 19: Reward [-7.20000000e+05 -2.51452976e+02], Length 48
Episode 20: Reward [-7.20000000e+05 -2.07808794e+02], Length 48
Episode 21: Reward [-7.20000000e+05 -1.66181174e+02], Length 48
Episode 22: Reward [-7.20000000e+05 -1.61851655e+02], Length 48
Episode 23: Reward [-7.20000000e+05 -2.04500623e+02], Length 48
Episode 24: Reward [-7.20000000e+05 -1.98958193e+02], Length 48
Episode 25: Reward [-7.20000000e+05 -2.44724245e+02], Length 48
Episode 26: Reward [-7.20000000e+05 -1.13220369e+02], Length 48
Episode 27: Reward [-7.20000000e+05 -2.41768983e+02], Length 48
Episode 28: Reward [-7.20000000e+05 -1.52732734e+02], Length 48
Episode 29: Reward [-7.20000000e+05 -2.53780535e+02], Length 48
Episode 30: Reward [-7.20000000e+05 -1.74930295e+02], Length 48
Episode 31: Reward [-7.20000000e+05 -1.88246049e+02], Length 48
Episode 32: Reward [-7.20000000e+05 -1.47085314e+02], Length 48
Episode 33: Reward [-7.2000000e+05 -2.0048956e+02], Length 48
Episode 34: Reward [-7.20000000e+05 -1.80566814e+02], Length 48
Episode 35: Reward [-7.20000000e+05 -2.02427959e+02], Length 48
Episode 36: Reward [-7.20000000e+05 -1.74649674e+02], Length 48
Episode 37: Reward [-7.20000000e+05 -2.62026473e+02], Length 48
Episode 38: Reward [-7.20000000e+05 -1.74426091e+02], Length 48
Episode 39: Reward [-7.20000000e+05 -1.74365297e+02], Length 48
Episode 40: Reward [-7.20000000e+05 -2.00274517e+02], Length 48
Episode 41: Reward [-7.20000000e+05 -2.46783473e+02], Length 48

============================================================
Training Completed!
============================================================
Total training time: 3.40 seconds (0.00 hours)

Performing final evaluation...

Final Performance (50 episodes):
  Cost reward: -720000.000 ± 0.000
  Stability reward: -189.694 ± 37.099
  Scalarized reward: -432075.878 ± 14.840
Model saved to ./models/energynet_training_final.pth

Results saved:
  Config: ./energynet_training_config.json
  Results: ./energynet_training_results.json
  Final model: ./models/energynet_training_final.pth
  Tensorboard logs: ./logs/energynet_training_1753607390

Training completed successfully!
Final scalarized performance: -432075.878
Copying results back to original directory...
Models copied to: /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing/models/
Logs copied to: /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing/logs/
Best model copied to: /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing/../../best_model.zip

==========================================
EnergyNet training completed successfully!
==========================================
SLURM Job ID: 323274
Training Episodes: 2000
Results copied back to: /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing

Results should be in:
  - /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing/models/         (trained model files)
  - /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing/plots/          (training plots and analysis)
  - /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing/logs/           (training logs)
  - /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing/runs/           (tensorboard logs)
  - /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing/checkpoints/    (training checkpoints)

To view results:
  ls -la /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing/models/ /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing/plots/ /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing/logs/

To view tensorboard logs:
  tensorboard --logdir /home/matan.biton/EnergyNetMultiObjectiveISOWrapper/multi_objecctive_iso_algo/mo_sac_testing/runs/ --host 0.0.0.0 --port 6006

To test the trained model:
  sbatch -c 2 --gres=gpu:1 ./run_test_trained_model.sh

SLURM output files:
  - slurm_energynet_323274.out (standard output)
  - slurm_energynet_323274.err (error output)
Cleaning up temporary directory: /tmp/energynet_training_matan.biton_2722186
